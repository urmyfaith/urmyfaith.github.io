<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="author" content="" />
<meta name="keywords" content="" />
<meta name="google-site-verification" content="RylW_eYZwk85sTyPMVT0Rw1yBeplLJEEuL1Z6WDKcq0" />
<meta name="baidu-tc-verification" content="6090c58a8b2b73e1c4820cd2aa2aa9a5" />
<title>elf+js: 文档 / 参与开发 / 开发规范</title>
<link rel="stylesheet" type="text/css" href="/assets/css/site.css" />
<link rel="stylesheet" type="text/css" href="/assets/css/docs.css" />
<link rel="stylesheet" type="text/css" href="/assets/css/code/github.css" />


</head>

<body>

<div id="Holder">
	<div id="MainPage" class="page-type-content page-type-docs">
		<div id="Header">
			<div class="layout-section">
				<div class="logo"><a href="http://elfjs.com/"><img src="/assets/img/logo-90x30.png" alt="elf+js" title="体验愉悦的JavaScript开发" /></a></div>
				<div class="additional">/ <a href="/docs/">文档</a>
<span class="sub-path">/ <a href="/docs/develop/">参与开发</a>
<span class="sub-path">/ <a href="/docs/develop/criterion.html">开发规范</a></span></span>
</div>
			</div>
			<div class="layout-aside">
				<ul>
					<li><a href="/">首页</a></li>
					<li><a href="/downloads/">下载</a></li>
					<li><a href="/docs/">文档</a></li>
					<li><a href="/blog/">博客</a></li>
				</ul>
			</div>
		</div>
		
		<div id="MainBody" class=""><div id="DocToc" class="layout-content-side">
	<div class="doc-menu">
		<h2><a href="#" title="点击回到顶部">内容目录</a></h2>
		<div class="doc-toc"></div>
	</div>
</div>
<div class="doc-main" title="双击隐藏/展开目录">
	<form action="/search/" method="get" class="search-box"><input type="search" name="q" placeholder="搜索" /><button type="submit" class="button">Q</button></form>
	<div id="DocContent" class="doc-content">
		<h1>开发规范</h1>
		<ul id="markdown-toc">
  <li><a href="#section">目的与原则</a></li>
  <li><a href="#section-1">文件组织规范</a></li>
  <li><a href="#section-2">代码规范</a>    <ul>
      <li><a href="#section-3">命名规范</a>        <ul>
          <li><a href="#jslib-">[ jslib ]</a></li>
          <li><a href="#elf-">[ elf ]</a></li>
        </ul>
      </li>
      <li><a href="#section-4">书写规范</a>        <ul>
          <li><a href="#section-5">注释</a>            <ul>
              <li><a href="#section-6">文档注释</a></li>
              <li><a href="#section-7">代码注释</a></li>
            </ul>
          </li>
          <li><a href="#section-8">缩进和对齐</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#section-9">版本控制</a>    <ul>
      <li><a href="#section-10">分支管理</a></li>
      <li><a href="#section-11">发布周期</a></li>
      <li><a href="#section-12">版本号相关</a></li>
      <li><a href="#section-13">新版本发布步骤</a>        <ul>
          <li><a href="#github">Github操作</a></li>
          <li><a href="#section-14">版本文件发布</a></li>
          <li><a href="#section-15">网站内容更新</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="section">目的与原则</h2>

<p>为了整体代码风格统一，思想一致，所有参与本项目的开发者须了解并遵守本文的。</p>

<p>elf+js项目旨在积累大量的JavaScript常用基础方法，解决开发中浏览器兼容性问题，形成一套组织结构合理功能丰富的基础库。并在此之上通过易用性的设计，简化大多数常用方法的入口书写方式，给使用elf+js基础库的应用开发者带来愉悦的开发体验。</p>

<p>所以开发elf+js项目需要遵循以下原则：</p>

<ul>
  <li>针对jslib基础库
    <ol>
      <li>每个设计的功能解决单一的一类问题（单一职责）；</li>
      <li>所设计的功能都只解决共性问题，不因为业务特定问题设计新功能；</li>
      <li>每一类功能由一个类（JavaScript对象或构造器）覆盖；</li>
    </ol>
  </li>
  <li>针对elf易用性封装；
    <ol>
      <li>不增加新功能，只完成对jslib中的易用性封装；</li>
      <li>缩短jslib中常用方法的调用入口；</li>
      <li>包含jslib的所有功能但不覆盖原有接口；</li>
      <li>只为常用方法设计；</li>
    </ol>
  </li>
</ul>

<h2 id="section-1">文件组织规范</h2>

<ol>
  <li>每个类一个文件，除非该类是静态类且对应一类功能的具体调用方法相关性不高时，可以把调用方法的文件分散到同名子级目录中；</li>
  <li>文件名同类名/方法名（包括大小写），但不需要包含完整的命名空间路径；</li>
  <li>解决同一领域问题的类划分为一个包，即文件夹；</li>
  <li>如果代码内容只是一个执行过程（如解决兼容性问题）时，则文件命名以“~”开头，并取符合内容意义的文件名；</li>
</ol>

<h2 id="section-2">代码规范</h2>

<h3 id="section-3">命名规范</h3>

<h4 id="jslib-">[ jslib ]</h4>

<ol>
  <li>包/类/方法/变量/常量等原则上参照Java的命名：
    <ol>
      <li>包名全部小写，原则上尽量短，只能使用一个单词或缩写单词；</li>
      <li>类名首字母大写，多单词驼峰；</li>
      <li>方法名首字母小写，多单词驼峰；</li>
      <li>变量名同方法名；</li>
      <li>常量全部字母大写，多单词下划线“_”连接；</li>
      <li>所有命名须使用尽量符合对应意义的英文单词或缩写，禁止使用汉语拼音；</li>
    </ol>
  </li>
  <li>顶级命名空间为<code>js.</code>；</li>
  <li>在<code>js</code>之下设置二级功能包，对应领域相关问题，任何一个类都必须定义在二级命名空间之下，即<code>js</code>命名空间下禁止放置任何类；</li>
  <li>二级包下可以放置类，在类较多（原则上超过30个）时，也可以划分更深层次的包，此级开始允许包内同时存在包和类；</li>
  <li>单纯的函数功能必须挂靠在一个静态类之下，以表明相关的功能相关性，禁止直接在包下直接申明函数；</li>
</ol>

<h4 id="elf-">[ elf ]</h4>

<p>elf由于不存在真正的实体，规范相对宽松。</p>

<h3 id="section-4">书写规范</h3>

<p>(to be writen…)</p>

<h4 id="section-5">注释</h4>

<p>注释不仅写给别人看，也是写给自己看的。</p>

<h5 id="section-6">文档注释</h5>

<p>我们使用ext-doc来生成基于文档注释的API手册，所以对每一个类和方法都需要编写文档注释。</p>

<h5 id="section-7">代码注释</h5>

<h4 id="section-8">缩进和对齐</h4>

<ol>
  <li>使用<strong>[TAB]</strong>作为缩进字符；</li>
  <li>如需要对齐赋值变量表，请使用<strong>空格</strong>而非[TAB]；</li>
</ol>

<h2 id="section-9">版本控制</h2>

<h3 id="section-10">分支管理</h3>

<dl>
  <dt>master</dt>
  <dd>主干分支，和正式发布版本保持完全一致</dd>
  <dt>dev</dt>
  <dd>开发分支，所有开发都必须使用非master的分支</dd>
  <dt>hotfix</dt>
  <dd>紧急修复分支，当某个产品线发现有线上问题急需修复时，从master创建一个临时修复分支来进行修复</dd>
</dl>

<h3 id="section-11">发布周期</h3>

<ol>
  <li>收集需求（wish-list）和问题反馈（bug-list），评估一份两周之内可以完成的且相关性较高的工作内容，在dev分支上开始开发；</li>
  <li>开发结束并测试通过后合并到master分支准备发布；</li>
</ol>

<h3 id="section-12">版本号相关</h3>

<ol>
  <li>对外发布使用三位版本号，如<code>0.3.0</code>；</li>
  <li>在下一版本要进行当前功能问题修复或相关功能小范围改进时，第三位版本号+1；</li>
  <li>在下一版本中部分接口发生调整或增加新功能时，第二位版本号+1；</li>
  <li>在整体大范围接口变动或组织结构重构时，首位版本号+1；</li>
</ol>

<h3 id="section-13">新版本发布步骤</h3>

<p>在确认一个版本的代码开发且测试完成后，进入以下发布的过程：</p>

<h4 id="github">Github操作</h4>

<ol>
  <li>merge相关版本的开发分支到主干分支（master），如有冲突需要全部解决，并push主干分支到github仓库；</li>
  <li>打版本标签（tag），格式为<code>v-x.x.x</code>，并push标签到github仓库；</li>
</ol>

<h4 id="section-14">版本文件发布</h4>

<ol>
  <li>使用<a href="https://github.com/elfjs/jslib-builder">jslib-builder工具</a>对开发完成的代码（包括jslib和elf）进行发布打包，包含源码文件和使用GCC压缩的文件，另使用7z工具对压缩后的文件再进行Gzip压缩，最终得到三个文件：
    <ul>
      <li>elf-x.x.x.js</li>
      <li>elf-x.x.x-min.js</li>
      <li>elf-x.x.x-min.js.gz</li>
    </ul>
  </li>
  <li>在Google code上的<a href="http://code.google.com/p/elfjs/">elfjs项目主页</a>下载页面中分别添加以上三个文件的下载；</li>
</ol>

<h4 id="section-15">网站内容更新</h4>

<p>elf+js的网站项目（<a href="https://github.com/elfjs/elfjs.github.com">elfjs.github.com</a>）也放在github上管理，大多数网站内容更新都需要涉及。例外的两个是：</p>

<ul>
  <li>在线打包工具：<a href="http://builder.elfjs.com/">http://builder.elfjs.com/</a></li>
  <li>API文档：<a href="http://api.elfjs.com/">http://api.elfjs.com/</a></li>
</ul>

<p>所以网站内容更新主要是这三块内容。</p>

<p>关于家API文档：</p>

<ol>
  <li>使用<code>ext-doc</code>生成API文档（后续会升级到使用<code>jsduck</code>）；</li>
  <li>使用ftp或ssh工具将线上的<code>latest</code>文件夹改名为之前版本号；</li>
  <li>上传新生成的文档文件到<code>latest</code>文件夹；</li>
</ol>

<p>关于发布日志和下载：</p>

<ol>
  <li>编辑<code>/_config.yml</code>文件，修改<code>release</code>部分，移动之前的当前发布版本到历史版本中，在原位置添加新版本的发布信息，包括版本号、发布日期和SHA1验证码等；</li>
  <li>在<code>/_posts</code>目录添加一个发布日志文件（可复制之前的然后修改版本号得到），编辑发布相关的内容；</li>
  <li>本地运行<code>jekyll</code>并预览各页面和链接是否正常，验证后提交所有文件推送到github仓库自动更新在线页面。</li>
</ol>

<p>关于在线打包工具：</p>

<ol>
  <li>更新jslib-builder项目中的仓库子项目到master最新提交；</li>
  <li>删除原有线上仓库文件；</li>
  <li>使用ftp或ssh工具将新的仓库文件上传到线上；</li>
</ol>

<p>-EOF-</p>

	</div>
</div>
</div>
		
		<div id="Footer">
			<p>该项目所有代码使用<a href="http://github.com/elfjs/" target="_blank">github</a>托管，并以<a href="/LICENSE" target="_blank">MIT协议</a>授权许可。[<a href="/docs/develop/contributor.html">贡献者</a>]</p>
			<p>&copy; Since 2011 <a href="http://elfjs.com/">elfjs.com</a> | <a href="http://groups.google.com/group/elfjs" target="_blank">Google Group</a> | <a href="#" class="email-link">elfjs<span class="symbol">[at]</span>googlegroups<span class="symbol">[dot]</span>com</a></p>
		</div>
	</div>
</div>

<script src="http://elfjs.qiniudn.com/code/elf-0.5.0.min.js"></script>
<script src="/assets/js/site.js"></script>
<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>


<div style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fc721ec118ef865ee41646415bc0e9734' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-27954937-1']);
_gaq.push(['_trackPageview']);

(function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
</div>

</body>
</html>
